---
- name: "Bring up docker containers for docker connection inventory iface"
  hosts: localhost
  roles:
    - role: provision_docker
      provision_docker_privileged: true,
      provision_docker_inventory_group: "{{ groups['robots'] }}"
      provision_docker_use_docker_connection: true

- hosts: robots
  tasks:
    - name: "Say hello to my new containers"
      ping:

    - name: "Install required pip3 packages"
      pip:
        executable: pip3
        name:
          - vcert
      when: "'python3' in inventory_hostname"

    - name: "Install required pip2 packages"
      pip:
        name:
          - vcert
      when: "'python2' in inventory_hostname"

#    - name: "Enroll fake certificate"
    - venafi_certificate:
        test_mode: true
        cert_path: "/tmp/fake.venafi.example.cert.pem"
        privatekey_path: "/tmp/fake.venafi.example.cert.key"
        privatekey_type: "RSA"
        privatekey_size: 8192
        privatekey_passphrase: "password"
        common_name: "fake.venafi.example.com"
        mode: "u=rwx,g=rwx,o=rwx"